<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Board">
	
	<insert id="b_insert">
		insert into board (bno,mno,title,content,category,regdate,type,moddate) values 
		(nextval('bno'),#{id},'#{title},#{content},'속닥속닥',sysdate(),1,sysdate())
	</insert>
	
	<!-- 게시판 리스트 가져오기 -->
	<select id="b_list" resultType="b">
		select b.*,id,nickname from member m join board b where m.mno = b.mno
		<!-- <![CDATA[   select * from (select @rownum:=@rownum+1 as rnum, A.* from board A, (select @rownum:=0) TMP) TPM where rnum <= #{end} and rnum >= #{start}  ]]> -->
		<!-- <![CDATA[select * from (select rownum as rnum, e.* from (select * from board order by bno desc) e) where rnum <= #{end} and rnum >= #{start}]]> -->
		<!-- 부등호를 사용할경우 '>', '<' 같은게 코드랑 겹치기 때문에 <![CDATA[]]> 방법을 쓴다!  -->
	</select>
	<!-- select * from (select @rownum:=@rownum+1 as rnum, A.* from board A, (select @rownum:=0) TMP) TPM where rnum > 1 and rnum < 5; -->
	
	<!-- 게시판 내용 가져오기 -->
	<select id="b_board" resultType="b">
		select * from member m join board b where m.mno = b.mno and b.bno = #{bno};
	</select>
	
	<!-- 게시판 조회수 올리기 -->
	<update id="b_cnt">
		update board set cnt=cnt+1 where bno =#{bno}  
	</update>

	<insert id="b_update">
		update board set user_id=#{user_id} ,title=#{title} ,content=#{content},
		moddate=sysdate() where bno = #{bno}
	</insert>
	
	<insert id="b_delete">
		delete from board where bno = #{bno}
	</insert>

	<select id="b_count" resultType="b">
		select * from board
	</select>
	
	<update id="b_rcnt">
		update board set rcnt=rcnt+1 where bno=#{bno} 
	</update>
	
	<select id="b_list_search" resultType="b">
		select * from board where ${search_type} like '%'||#{search}||'%'      
	</select>
	<!-- like문은 조금 다르다.. ${}와 #{}차이도 무엇인지 알아봐야할 필요가 있다 -->
</mapper>